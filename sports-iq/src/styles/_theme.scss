@use '@angular/material' as mat;
@use './_theme-colors' as themeColors;
@use './partials/colors' as *;

// -----------------------------------------------------------------------------
// Fintech Sports Theme (Material 3)
// Feel: High-frequency trading meets live sports feed.
// Brand: Electric Blue primary, crisp dark surfaces, neon data signals.
// -----------------------------------------------------------------------------

// 1. Typography (modern, data-centric)
$font-brand: 'Manrope', sans-serif;
$font-plain: 'Manrope', sans-serif;
$font-mono: 'Roboto Mono', monospace;

@mixin sports-iq-theme() {
  // 2. Material 3 Theme Definition
  $theme: mat.define-theme(
    (
      color: (
        primary: themeColors.$primary-palette,
        tertiary: themeColors.$tertiary-palette,
        theme-type: dark,
      ),
      typography: (
        brand-family: $font-brand,
        plain-family: $font-plain,
        bold-weight: 700,
        medium-weight: 500,
        regular-weight: 400,
      ),
      density: (
        scale: -2,
      ),
    )
  );

  // Apply the theme
  @include mat.all-component-themes($theme);

  // 3. Custom CSS Variables from _colors.scss
  html {
    // Surface & background system
    --siq-surface-0: #{$surface-0};
    --siq-surface-1: #{$surface-1};
    --siq-surface-2: #{$surface-2};
    --siq-surface-3: #{$surface-3};
    --siq-outline: #{$outline-color};
    --siq-border-color: #{$outline-color};

    // Text colors
    --siq-text-primary: #{$text-primary};
    --siq-text-secondary: #{$text-secondary};
    --siq-text-muted: #{$text-muted};

    // Brand colors
    --siq-brand-gold: #{$brand-gold};
    --siq-brand-gold-hover: #{$brand-gold-hover};
    --siq-brand-gold-container: #{$brand-gold-container};

    --siq-accent-purple: #{$accent-purple};
    --siq-accent-purple-hover: #{$accent-purple-hover};
    --siq-accent-purple-container: #{$accent-purple-container};

    // Semantic colors
    --siq-success-green: #{$success-green};
    --siq-success-green-container: #{$success-green-container};
    --siq-success-green-text: #{$success-green-text};

    --siq-info-cyan: #{$info-cyan};
    --siq-info-cyan-container: #{$info-cyan-container};
    --siq-info-cyan-text: #{$info-cyan-text};

    --siq-warning-amber: #{$warning-amber};
    --siq-warning-amber-container: #{$warning-amber-container};
    --siq-warning-amber-text: #{$warning-amber-text};

    --siq-error-red: #{$error-red};
    --siq-error-red-hover: #{$error-red-hover};
    --siq-error-red-container: #{$error-red-container};
    --siq-error-red-text: #{$error-red-text};

    // Gradients
    --siq-gradient-blue: #{$gradient-blue};
    --siq-gradient-purple: #{$gradient-purple};
    --siq-gradient-success: #{$gradient-success};

    // Material override anchors
    --mat-app-background-color: var(--siq-surface-0);
    --mat-app-surface: var(--siq-surface-1);
    --mat-app-on-surface: var(--siq-text-primary);

    background: var(--siq-surface-0);
    color: var(--siq-text-primary);

    body {
      margin: 0;
    }

    // Elevated element style helpers
    .elevated,
    .mat-mdc-menu-panel {
      background-color: var(--siq-surface-1);
      border: 1px solid var(--siq-outline);
      backdrop-filter: blur(6px);
    }

    // Interactive row hover
    .hover-row:hover {
      background-color: var(--siq-surface-2);
    }

    // Outline style for focus rings
    :focus-visible {
      outline: 2px solid var(--siq-brand-gold);
      outline-offset: 2px;
    }

    // Data mono font helper
    .data-font {
      font-family: $font-mono !important;
      letter-spacing: -0.25px;
    }
  }

  // 4. Material Component Overrides
  @include mat.card-overrides(
    (
      elevated-container-color: var(--siq-surface-2),
      filled-container-color: var(--siq-surface-2),
      outlined-container-color: var(--siq-surface-2),
    )
  );

  // 5. Data Semantics
  .trend-up,
  .value-up {
    color: var(--siq-success-green);
    text-shadow: 0 0 12px rgba(0, 200, 5, 0.25);
  }

  .trend-down,
  .value-down {
    color: var(--siq-error-red);
  }

  .value-neutral {
    color: var(--siq-text-secondary);
  }

  // 6. Badges / Chips
  mat-chip {
    &.primary {
      @include mat.chips-overrides(
        (
          outline-color: var(--siq-brand-gold),
          label-text-color: var(--siq-brand-gold),
        )
      );
    }

    &.info {
      @include mat.chips-overrides(
        (
          outline-color: var(--siq-info-cyan),
          label-text-color: var(--siq-info-cyan),
        )
      );
    }

    &.warning {
      @include mat.chips-overrides(
        (
          outline-color: var(--siq-warning-amber),
          label-text-color: var(--siq-warning-amber),
          elevated-container-color: rgba(var(--siq-warning-amber), 0.15),
        )
      );
    }

    &.accent {
      @include mat.chips-overrides(
        (
          outline-color: var(--siq-accent-purple),
          label-text-color: var(--siq-accent-purple),
        )
      );
    }

    &.success {
      @include mat.chips-overrides(
        (
          outline-color: var(--siq-success-green),
          label-text-color: var(--siq-success-green),
        )
      );
    }

    &.error {
      @include mat.chips-overrides(
        (
          outline-color: var(--siq-error-red),
          label-text-color: var(--siq-error-red),
        )
      );
    }
  }

  // 8. Tables / Gridlines
  .data-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 4px;
  }

  .data-table thead th {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.08rem;
    font-weight: 600;
    color: var(--siq-text-secondary);
  }

  .data-table tbody tr {
    background: var(--siq-surface-1);
  }

  .data-table tbody tr td {
    padding: 0.6rem 0.9rem;
    font-size: 0.78rem;
  }

  .data-table tbody tr:hover {
    background: var(--siq-surface-2);
  }

  // 9. Score / Live Status Tags
  .status-live {
    color: var(--siq-success-green);
    font-weight: 600;
    text-shadow: 0 0 10px var(--siq-success-green);
  }

  .status-final {
    color: var(--siq-text-secondary);
    font-style: italic;
  }

  .status-upcoming {
    color: var(--siq-accent-purple);
  }

  // 10. Card Header Accent Border
  .panel-header-accent {
    border-bottom: 2px solid var(--siq-brand-gold);
  }

  // 11. Gradient Bar Utility (e.g., win probability visual)
  .gradient-bar {
    height: 6px;
    background: var(--siq-gradient-success);
    border-radius: 999px;
  }

  // 12. Sparkline Container (future injection point)
  .sparkline-slot {
    height: 36px;
    display: flex;
    align-items: center;
  }

  // 13. Scrollbar Styling (WebKit only fallback)
  ::-webkit-scrollbar {
    width: 10px;
  }

  ::-webkit-scrollbar-track {
    background: var(--siq-surface-0);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--siq-surface-2);
    border-radius: 8px;
    border: 2px solid var(--siq-surface-0);
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--siq-surface-3);
  }
}
